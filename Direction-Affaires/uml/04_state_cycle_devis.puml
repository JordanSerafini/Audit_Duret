@startuml State_Cycle_Devis

title State Diagram - Cycle de Vie d'un Devis

[*] --> DemandeClient : Client demande devis

state "Demande Client" as DemandeClient #90EE90
note right of DemandeClient
  Email du client
  Sp√©cifications projet
  D√©lai: 48-72h attendu
end note

DemandeClient --> RechercheTemplate : Laurent cherche ancien devis

state "Recherche Template" as RechercheTemplate #FF6B6B
note right of RechercheTemplate
  üî¥ **RECHERCHE MANUELLE**
  - Fouille dossiers partag√©s
  - 200+ fichiers Word
  - Nommage incoh√©rent:
    "PPSPS_final_v2_OK_2023.docx"
    "PPSPS_Client_A_VRAI_FINAL.docx"
  - Pas de versioning
  ‚è∞ 30 min de fouille !
end note

RechercheTemplate --> PasDeTemplate : Pas trouv√© similaire
RechercheTemplate --> OuvertureMDE : Template trouv√©

state "Pas de Template" as PasDeTemplate #FF6B6B
note left of PasDeTemplate
  üî¥ Part de z√©ro
  ‚è∞ +1h
end note

PasDeTemplate --> OuvertureMDE

state "Ouverture MDE" as OuvertureMDE #FF6B6B
note right of OuvertureMDE
  üî¥ **TEMPS CHARGEMENT**
  ‚è∞ 15 secondes
  Attente √©cran accueil: 30s
  Module devis: 40s
  ‚è∞ Total 5 min juste pour ouvrir !
end note

OuvertureMDE --> RechercheClient : Cherche client

state "Recherche Client" as RechercheClient #FFD700
note right of RechercheClient
  Liste clients (30s)
  Scroll + recherche (2 min)
end note

RechercheClient --> SaisieManuelle : Nouveau devis

state "Saisie Manuelle" as SaisieManuelle #FF6B6B {
  [*] --> SaisieLigne1
  SaisieLigne1 --> SaisieLigne2 : Popup 35s
  SaisieLigne2 --> SaisieLigne3 : Popup 35s
  SaisieLigne3 --> SaisieAutres : ...
  SaisieAutres --> [*] : 30 lignes
}

note right of SaisieManuelle
  üî¥ **CALVAIRE**
  30 lignes √ó 5min = 2h30

  Pour CHAQUE ligne:
  - Clic "Ajouter ligne"
  - Popup catalogue (35s)
  - Recherche article (2 min)
  - Copie depuis Excel perso
  - Sauvegarde (25s)

  ‚è∞ R√©duit √† 1h30 avec Excel
  mais TOUJOURS tr√®s long !
end note

SaisieManuelle --> VerifExcel : V√©rifications

state "V√©rification Excel" as VerifExcel #FFD700
note left of VerifExcel
  - Marge globale
  - Prix vs concurrence
  - Coh√©rence quantit√©s
  ‚è∞ 10 min
end note

VerifExcel --> Ajustements : Corrections n√©cessaires
VerifExcel --> GenerationPDF : OK

state "Ajustements" as Ajustements #FFD700
note right of Ajustements
  üî¥ Re-chargements (5 min)
  Modifier 2-3 lignes
end note

Ajustements --> GenerationPDF

state "G√©n√©ration PDF" as GenerationPDF #FFD700
note right of GenerationPDF
  Clic "G√©n√©rer PDF"
  PDF (45s)
end note

GenerationPDF --> VerifPDF : V√©rifie mise en page

state "V√©rification PDF" as VerifPDF #FFD700
note left of VerifPDF
  üî¥ Parfois bugs affichage
  ‚Üí R√©g√©n√©ration
  ‚è∞ 3 min
end note

VerifPDF --> BugPDF : Bug affichage
VerifPDF --> EnvoiClient : PDF OK

state "Bug PDF" as BugPDF #FF6B6B
BugPDF --> GenerationPDF : R√©g√©n√®re

state "Envoi Client" as EnvoiClient #90EE90
note right of EnvoiClient
  - R√©daction email
  - Recherche contact
  - Pi√®ce jointe
  ‚è∞ 7 min
end note

EnvoiClient --> EnAttente : Email envoy√©

state "En Attente" as EnAttente #FFFFAA
note right of EnAttente
  Attente r√©ponse client
  24-72h
end note

EnAttente --> Refus : Client refuse
EnAttente --> Accepte : Client accepte
EnAttente --> Modification : Client demande ajustement

state "Modification Demand√©e" as Modification #FFD700
note left of Modification
  Retour √† la saisie
  üî¥ Recommence processus
end note

Modification --> OuvertureMDE : Rouvre MDE

state "‚ùå Refus" as Refus #FF6B6B
Refus --> [*]

state "‚úÖ Accept√©" as Accepte #90EE90
Accepte --> [*]

note bottom
  **M√âTRIQUES GLOBALES**
  ‚è∞ Dur√©e totale: **2h05**

  D√©composition:
  ‚Ä¢ Recherche ancien devis: 45 min
  ‚Ä¢ Ouverture MDE: 5 min
  ‚Ä¢ Saisie 30 lignes: 1h30
  ‚Ä¢ V√©rifications: 15 min
  ‚Ä¢ PDF & envoi: 10 min

  üò§ **FRUSTRATION: 9/10**
  üî¥ Avec templates: 30 min possible !
  √âconomie potentielle: 1h35/devis
end note

@enduml
