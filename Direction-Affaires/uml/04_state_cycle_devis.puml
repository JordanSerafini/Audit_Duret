@startuml State_Cycle_Devis

title State Diagram - Cycle de Vie d'un Devis

[*] --> DemandeClient : Client demande devis

state "Demande Client" as DemandeClient #90EE90
note right of DemandeClient
  Email du client
  SpÃ©cifications projet
  DÃ©lai: 48-72h attendu
end note

DemandeClient --> RechercheTemplate : Laurent cherche ancien devis

state "Recherche Template" as RechercheTemplate #FF6B6B
note right of RechercheTemplate
  ğŸ”´ **RECHERCHE MANUELLE**
  - Fouille dossiers partagÃ©s
  - 200+ fichiers Word
  - Nommage incohÃ©rent:
    "PPSPS_final_v2_OK_2023.docx"
    "PPSPS_Client_A_VRAI_FINAL.docx"
  - Pas de versioning
  â° 30 min de fouille !
end note

RechercheTemplate --> PasDeTemplate : Pas trouvÃ© similaire
RechercheTemplate --> OuvertureMDE : Template trouvÃ©

state "Pas de Template" as PasDeTemplate #FF6B6B
note left of PasDeTemplate
  ğŸ”´ Part de zÃ©ro
  â° +1h
end note

PasDeTemplate --> OuvertureMDE

state "Ouverture MDE" as OuvertureMDE #FF6B6B
note right of OuvertureMDE
  ğŸ”´ **TEMPS CHARGEMENT**
  â° 15 secondes
  Attente Ã©cran accueil: 30s
  Module devis: 40s
  â° Total 5 min juste pour ouvrir !
end note

OuvertureMDE --> RechercheClient : Cherche client

state "Recherche Client" as RechercheClient #FFD700
note right of RechercheClient
  Liste clients (30s)
  Scroll + recherche (2 min)
end note

RechercheClient --> SaisieManuelle : Nouveau devis

state "Saisie Manuelle" as SaisieManuelle #FF6B6B {
  [*] --> SaisieLigne1
  SaisieLigne1 --> SaisieLigne2 : Popup 35s
  SaisieLigne2 --> SaisieLigne3 : Popup 35s
  SaisieLigne3 --> SaisieAutres : ...
  SaisieAutres --> [*] : 30 lignes
}

note right of SaisieManuelle
  ğŸ”´ **CALVAIRE**
  30 lignes Ã— 5min = 2h30

  Pour CHAQUE ligne:
  - Clic "Ajouter ligne"
  - Popup catalogue (35s)
  - Recherche article (2 min)
  - Copie depuis Excel perso
  - Sauvegarde (25s)

  â° RÃ©duit Ã  1h30 avec Excel
  mais TOUJOURS trÃ¨s long !
end note

SaisieManuelle --> VerifExcel : VÃ©rifications

state "VÃ©rification Excel" as VerifExcel #FFD700
note left of VerifExcel
  - Marge globale
  - Prix vs concurrence
  - CohÃ©rence quantitÃ©s
  â° 10 min
end note

VerifExcel --> Ajustements : Corrections nÃ©cessaires
VerifExcel --> GenerationPDF : OK

state "Ajustements" as Ajustements #FFD700
note right of Ajustements
  ğŸ”´ Re-chargements (5 min)
  Modifier 2-3 lignes
end note

Ajustements --> GenerationPDF

state "GÃ©nÃ©ration PDF" as GenerationPDF #FFD700
note right of GenerationPDF
  Clic "GÃ©nÃ©rer PDF"
  PDF (45s)
end note

GenerationPDF --> VerifPDF : VÃ©rifie mise en page

state "VÃ©rification PDF" as VerifPDF #FFD700
note left of VerifPDF
  ğŸ”´ Parfois bugs affichage
  â†’ RÃ©gÃ©nÃ©ration
  â° 3 min
end note

VerifPDF --> BugPDF : Bug affichage
VerifPDF --> EnvoiClient : PDF OK

state "Bug PDF" as BugPDF #FF6B6B
BugPDF --> GenerationPDF : RÃ©gÃ©nÃ¨re

state "Envoi Client" as EnvoiClient #90EE90
note right of EnvoiClient
  - RÃ©daction email
  - Recherche contact
  - PiÃ¨ce jointe
  â° 7 min
end note

EnvoiClient --> EnAttente : Email envoyÃ©

state "En Attente" as EnAttente #FFFFAA
note right of EnAttente
  Attente rÃ©ponse client
  24-72h
end note

EnAttente --> Refus : Client refuse
EnAttente --> Accepte : Client accepte
EnAttente --> Modification : Client demande ajustement

state "Modification DemandÃ©e" as Modification #FFD700
note left of Modification
  Retour Ã  la saisie
  ğŸ”´ Recommence processus
end note

Modification --> OuvertureMDE : Rouvre MDE

state "âŒ Refus" as Refus #FF6B6B
Refus --> [*]

state "âœ… AcceptÃ©" as Accepte #90EE90
Accepte --> [*]

note bottom
  **MÃ‰TRIQUES GLOBALES**
  â° DurÃ©e totale: **2h05**

  DÃ©composition:
  â€¢ Recherche ancien devis: 45 min
  â€¢ Ouverture MDE: 5 min
  â€¢ Saisie 30 lignes: 1h30
  â€¢ VÃ©rifications: 15 min
  â€¢ PDF & envoi: 10 min

  ğŸ˜¤ **FRUSTRATION: 9/10**
  ğŸ”´ Avec templates: 30 min possible !
  ğŸ’° Ã‰conomie potentielle: 1h35/devis
end note

@enduml
