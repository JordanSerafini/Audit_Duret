@startuml Architecture_IT_Cible

title Architecture IT Cible - Achats & Logistique

!define CLOUD_COLOR #E8F4F8
!define APP_COLOR #B8E6B8
!define DATA_COLOR #FFE4B5
!define INTEGRATION_COLOR #E6D4FF

skinparam component {
  BackgroundColor<<cloud>> CLOUD_COLOR
  BackgroundColor<<app>> APP_COLOR
  BackgroundColor<<data>> DATA_COLOR
  BackgroundColor<<integration>> INTEGRATION_COLOR
}

package "Utilisateurs" {
  actor "ğŸ‘· Chefs\nChantier" as Marc
  actor "ğŸ‘©â€ğŸ’¼ Gestionnaire\nAchats" as Sylvie
  actor "ğŸ“¦ Magasiniers" as Eric
  actor "ğŸ‘¨â€ğŸ’¼ Resp.\nAffaires" as Julien
  actor "ğŸ‘©â€ğŸ’¼ Direction" as Christine
}

package "Couche PrÃ©sentation" <<app>> {
  [ğŸ“± Mobile App\nReact Native] as MobileApp
  [ğŸ’» Web App\nReact/Vue.js] as WebApp
  [ğŸ–¥ï¸ Terminal DÃ©pÃ´t\nPWA] as TerminalApp
  [ğŸ“Š Dashboard BI\nMetabase] as DashboardBI
}

package "Couche Application (Microservices)" <<app>> {
  [ğŸ›’ E-Procurement\nService] as EProcurement
  [âœ… Workflow\nService] as Workflow
  [ğŸ“‹ Catalogue\nService] as Catalogue
  [ğŸ“¦ Stock\nService] as Stock
  [ğŸ¤ Fournisseurs\nService] as Fournisseurs
  [ğŸ”” Notifications\nService] as Notifications
  [ğŸ“ 3-way Matching\nService] as Matching
}

package "Couche DonnÃ©es" <<data>> {
  database "PostgreSQL\nPrincipal" as MainDB
  database "Redis\nCache" as Cache
  database "Data Lake\nS3/MinIO" as DataLake
  database "Elasticsearch\nSearch" as Search
}

package "IntÃ©grations" <<integration>> {
  [ğŸ”Œ Sage MDE\nConnector] as SageConnector
  [ğŸ”Œ Rexel API\nConnector] as RexelAPI
  [ğŸ”Œ Sonepar API\nConnector] as SoneparAPI
  [ğŸ“§ Email/SMS\nGateway] as EmailGateway
}

package "SystÃ¨mes Externes" {
  [Sage MDE\n(Legacy)] as SageMDE
  cloud "Rexel\nAPI" as Rexel
  cloud "Sonepar\nAPI" as Sonepar
  [ğŸ“Š BI/ML\nPlatform] as BIPlatform
}

' Relations Utilisateurs â†’ Apps
Marc --> MobileApp
Sylvie --> WebApp
Eric --> TerminalApp
Julien --> WebApp
Christine --> DashboardBI

' Relations Apps â†’ Services
MobileApp --> EProcurement
MobileApp --> Catalogue
MobileApp --> Stock

WebApp --> EProcurement
WebApp --> Workflow
WebApp --> Catalogue
WebApp --> Fournisseurs
WebApp --> Matching

TerminalApp --> Stock
TerminalApp --> Catalogue

DashboardBI --> BIPlatform

' Relations Services â†’ Services
EProcurement --> Workflow
EProcurement --> Catalogue
EProcurement --> Notifications

Workflow --> Notifications

Stock --> Notifications

' Relations Services â†’ Data
EProcurement --> MainDB
Workflow --> MainDB
Catalogue --> MainDB
Stock --> MainDB
Fournisseurs --> MainDB
Matching --> MainDB

EProcurement --> Cache
Catalogue --> Cache
Stock --> Cache

EProcurement --> DataLake
Stock --> DataLake
Workflow --> DataLake

Catalogue --> Search

' Relations Services â†’ IntÃ©grations
Stock --> SageConnector
Catalogue --> SageConnector

EProcurement --> RexelAPI
EProcurement --> SoneparAPI
Fournisseurs --> RexelAPI
Fournisseurs --> SoneparAPI

Notifications --> EmailGateway

' Relations IntÃ©grations â†’ Externes
SageConnector <--> SageMDE
RexelAPI <--> Rexel
SoneparAPI <--> Sonepar

' Relations Data â†’ BI
DataLake --> BIPlatform

note bottom of EProcurement
  **Services Principaux**
  - Gestion commandes
  - Panier d'achat
  - Validation workflow
  - Historique
end note

note bottom of MainDB
  **DonnÃ©es Critiques**
  - Articles & catalogues
  - Commandes
  - Stock & mouvements
  - Fournisseurs
  - Utilisateurs
end note

note right of BIPlatform
  **Analytics & ML**
  - Dashboards temps rÃ©el
  - Reporting automatique
  - PrÃ©dictions ML
  - KPIs
end note

@enduml
