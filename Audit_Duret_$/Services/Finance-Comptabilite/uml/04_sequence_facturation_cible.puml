@startuml Sequence_Facturation_Cible

title Processus Facturation CIBLE (Odoo)

actor "ğŸ‘· Chef\nChantier" as Chef
participant "ğŸ“± Odoo Mobile\nApp" as MobileApp
participant "ğŸ”¨ Module\nChantiers" as ModuleChantier
participant "ğŸ“„ Module\nFacturation" as ModuleFacture
participant "ğŸ“’ Module\nComptabilitÃ©" as ModuleCompta
participant "ğŸ“§ Email\nGateway" as EmailGW
actor "ğŸ‘¤ Client" as Client
participant "ğŸ‘©â€ğŸ’¼ Comptable\n(optionnel)" as Comptable

== âœ… PHASE 1 : Validation Digitale Chantier (30 secondes) ==

Chef -> MobileApp : ğŸ“± Ouvre app\nsur smartphone
activate MobileApp #B8E6B8

MobileApp --> Chef : ğŸ“‹ Liste chantiers\nen cours

Chef -> MobileApp : âœ… SÃ©lectionne\n"Chantier Dupont"

MobileApp --> Chef : ğŸ“Š DÃ©tails chantier :\n- Temps saisi : 45h\n- MatÃ©riaux scannÃ©s : âœ“\n- Devis liÃ© : âœ“

note right of Chef
  ğŸ˜Š Satisfait
  Toutes les infos
  dÃ©jÃ  lÃ  !
end note

Chef -> MobileApp : âœ… Bouton\n"VALIDER CHANTIER"

MobileApp -> ModuleChantier : ğŸ”„ Validation\nchantier Dupont
deactivate MobileApp

== âœ… PHASE 2 : GÃ©nÃ©ration Automatique Facture (InstantanÃ©) ==

activate ModuleChantier #B8E6B8

ModuleChantier -> ModuleChantier : ğŸ¤– RÃ©cupÃ©ration auto :\n- Temps : 45h Ã— 65â‚¬/h\n- MatÃ©riaux : Liste scannÃ©e\n- Devis : Lignes liÃ©es\n- Client : Dupont (CRM)

ModuleChantier -> ModuleFacture : ğŸ”„ GÃ©nÃ©ration\nfacture brouillon
deactivate ModuleChantier
activate ModuleFacture #B8E6B8

ModuleFacture -> ModuleFacture : ğŸ¤– Calcul automatique :\n- MO : 45h Ã— 65â‚¬ = 2925â‚¬\n- MatÃ©riaux : 645â‚¬\n- Total HT : 3570â‚¬\n- TVA 20% : 714â‚¬\n- Total TTC : 4284â‚¬

ModuleFacture -> ModuleCompta : âœ… Ã‰criture comptable\nAUTO-GÃ‰NÃ‰RÃ‰E
activate ModuleCompta #E6F3FF
ModuleCompta --> ModuleFacture : âœ… Ã‰criture OK
deactivate ModuleCompta

note right of ModuleFacture
  ğŸ¤– Automatique
  - Client liÃ© (CRM)
  - Analytique chantier
  - TVA calculÃ©e
  - NÂ° facture auto
end note

== âœ… PHASE 3 : Validation Comptable (Optionnelle - 2 min) ==

ModuleFacture -> Comptable : ğŸ”” Notification :\n"Facture brouillon\nChantier Dupont\nprÃªte Ã  valider"
activate Comptable #B8E6B8

note right of Comptable
  ğŸ˜Š Satisfait
  Juste Ã  vÃ©rifier,
  pas de ressaisie !
end note

Comptable -> ModuleFacture : ğŸ” Consultation\nfacture brouillon

ModuleFacture --> Comptable : ğŸ“„ Facture prÃ©-remplie :\n- Client : Dupont âœ“\n- Montant : 4284â‚¬ TTC âœ“\n- DÃ©tails : OK âœ“

alt Facture OK (95% des cas)
  Comptable -> ModuleFacture : âœ… VALIDATION\n(1 clic)
else Ajustement nÃ©cessaire (5% des cas)
  Comptable -> ModuleFacture : âœï¸ Ajustement mineur\n(ex: remise)
  Comptable -> ModuleFacture : âœ… VALIDATION
end

deactivate Comptable

== âœ… PHASE 4 : Envoi Automatique (InstantanÃ©) ==

ModuleFacture -> ModuleFacture : ğŸ“„ GÃ©nÃ©ration PDF\nautomatique

ModuleFacture -> EmailGW : ğŸ“§ Envoi email\nautomatique
activate EmailGW #B8E6B8

EmailGW -> Client : ğŸ“© Email personnalisÃ© :\n"Bonjour M. Dupont,\nVoici votre facture\npour les travaux terminÃ©s\nle [date].\nCordialement"
deactivate EmailGW
deactivate ModuleFacture

note right of Client
  ğŸ˜„ TrÃ¨s satisfait
  Facture reÃ§ue
  < 48h aprÃ¨s travaux
  (vs 5-10 jours avant)
end note

== âœ… BONUS : TraÃ§abilitÃ© ComplÃ¨te ==

note over ModuleChantier, ModuleCompta
  ğŸ” **TRAÃ‡ABILITÃ‰ TOTALE** :

  âœ… Chantier â†’ Temps saisis (45h)
  âœ… Chantier â†’ MatÃ©riaux scannÃ©s
  âœ… Chantier â†’ Facture (F2025-0847)
  âœ… Facture â†’ Ã‰criture comptable
  âœ… Facture â†’ Imputation analytique
  âœ… Facture â†’ PrÃ©vision trÃ©sorerie
  âœ… Email â†’ Client (horodatÃ©)

  ğŸ” Historique complet consultable
  ğŸ” Audit trail permanent
end note

== â±ï¸ BILAN TEMPS TOTAL ==

note over Chef, Client
  **TEMPS TOTAL : < 48 HEURES**

  â° Validation chef chantier : 30 secondes
  â° GÃ©nÃ©ration auto facture : InstantanÃ©
  â° Validation comptable : 2 min (optionnel)
  â° Envoi auto client : InstantanÃ©

  **TOTAL ACTIF : ~4 MINUTES**
  **TOTAL DÃ‰LAI : < 48 HEURES**

  âœ… **BÃ‰NÃ‰FICES :**
  - Gain temps : 87 min â†’ 4 min (-95%)
  - Gain dÃ©lai : 5-10j â†’ < 48h (-90%)
  - ZÃ©ro ressaisie (vs 3 ressaisies avant)
  - TraÃ§abilitÃ© complÃ¨te
  - Comptable focus validation vs saisie

  ğŸ˜„ **SATISFACTION :**
  - Chef chantier : 10/10 (validation 1 clic)
  - Gestionnaire : 10/10 (plus de collecte)
  - Comptable : 9/10 (valorisation mÃ©tier)
  - Client : 10/10 (rapiditÃ©)

  ğŸ’° **IMPACT TRÃ‰SORERIE :**
  - Encaissement +5 jours plus tÃ´t
  - Sur 100 factures/mois = Gain trÃ©sorerie significatif
end note

@enduml
