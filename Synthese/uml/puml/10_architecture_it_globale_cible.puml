@startuml 10_architecture_it_globale_cible

' === METADATA ===
' Service: Synthese Transverse
' Date Creation: 2025-11-20
' Auteur: Agent PlantUML Duret
' Version: 1.0
' Type Diagramme: Component C4
' Description: Vision unifiee de l'architecture IT cible apres transformation
' === FIN METADATA ===

!include ../../../Services/_shared/uml/styles/duret_colors.puml
!include ../../../Services/_shared/uml/styles/duret_layout.puml
!include ../../../Services/_shared/uml/styles/duret_legends.puml

title Architecture IT Globale - VISION CIBLE (ECOSYSTEME UNIFIE)

' === COUCHE UTILISATEURS ===
package "80 UTILISATEURS DURET ELECTRICITE" {

  actor "30 Users Bureau\n(DA, SC, RH, GO)" as USERS_BUREAU COLOR_ACTOR_BUREAU
  actor "50 Users Terrain\n(Chantiers, MT, Depot)" as USERS_TERRAIN COLOR_ACTOR_CHANTIER

  note right of USERS_BUREAU
    EMO_SUCCESS Interface web unique
    EMO_SUCCESS Single Sign-On (SSO)
    EMO_SUCCESS Acces temps reel
  end note

  note right of USERS_TERRAIN
    EMO_SUCCESS Apps mobiles offline
    EMO_SUCCESS Sync automatique
    EMO_SUCCESS Geolocalisation
  end note
}

' === COUCHE APPLICATIONS ===
package "PLATEFORME APPLICATIVE UNIFIEE" COLOR_SUCCESS {

  ' --- ERP ODOO ---
  package "ODOO ERP (COEUR SYSTEME)" COLOR_SYSTEME_ERP {
    [Module Ventes/CRM] as ODOO_CRM
    [Module Achats] as ODOO_ACHATS
    [Module Stock/Logistique] as ODOO_STOCK
    [Module Projets/Affaires] as ODOO_PROJETS
    [Module Comptabilite] as ODOO_COMPTA
    [Module Facturation] as ODOO_FACT

    note bottom of ODOO_PROJETS
      EMO_SUCCESS Source unique verite
      - Toutes affaires centralisees
      - Workflow validation integre
      - Reporting temps reel
    end note
  }

  ' --- APPS MOBILES ---
  package "APPLICATIONS MOBILES NATIVES" COLOR_SYSTEME_MOBILE {
    [App Chantiers\n(Android/iOS)] as APP_CHANTIERS
    [App Maintenance\n(Techniciens)] as APP_MT
    [App Commercial\n(Devis terrain)] as APP_COMMERCIAL

    note bottom of APP_CHANTIERS
      EMO_SUCCESS Fonctionnalites offline
      - Photos incidents/avancements
      - Rapports journaliers
      - Pointage geolocalise
      - Sync auto retour reseau
    end note
  }

  ' --- SIRH ---
  package "SIRH (LUCCA/PAYFIT)" COLOR_SYSTEME_SIRH {
    [Gestion Paie] as SIRH_PAIE
    [Conges/Absences] as SIRH_CONGES
    [Notes Frais] as SIRH_NDF
    [Onboarding] as SIRH_ONBOARD

    note bottom of SIRH_PAIE
      EMO_SUCCESS Integration automatique
      - Sync employes depuis Odoo
      - Variables paie auto
      - Exports DSN automatiques
    end note
  }

  ' --- CRM EXTERNE ---
  package "CRM HUBSPOT (GRATUIT)" COLOR_SYSTEME_CRM {
    [Contacts Prospects] as CRM_CONTACTS
    [Pipeline Ventes] as CRM_PIPELINE
    [Emailing Marketing] as CRM_EMAIL

    note bottom of CRM_PIPELINE
      EMO_SUCCESS Integration bidirectionnelle
      - Leads HubSpot -> Devis Odoo
      - Suivi opportunites unifie
    end note
  }
}

' === COUCHE INTEGRATION ===
package "COUCHE INTEGRATION (APIs)" COLOR_INTEGRATION {
  [API REST Odoo] as API_ODOO
  [Connecteur PayFit/Lucca] as API_SIRH
  [Webhook HubSpot] as API_CRM
  [API Apps Mobiles] as API_MOBILE
  [Queue RabbitMQ\n(Async)] as QUEUE

  note right of QUEUE
    EMO_SUCCESS Messaging asynchrone
    - Resilience erreurs
    - Retry automatique
    - Logs tracabilite
  end note
}

' === COUCHE DATA ===
package "INFRASTRUCTURE DATA & BI" COLOR_DATA {
  database "Data Warehouse\nPostgreSQL" as DWH {
    [Donnees Affaires]
    [Donnees RH]
    [Donnees Achats]
    [Donnees Chantiers]
  }

  cloud "Data Lake\n(Azure Blob)" as LAKE COLOR_SYSTEME_CLOUD

  [ETL Airbyte/Airflow] as ETL

  package "DASHBOARDS BI" as BI {
    [Power BI\nDirection] as BI_POWERBI
    [Metabase\nOperationnel] as BI_METABASE
  }

  note right of DWH
    EMO_SUCCESS Single Source of Truth
    - Consolidation multi-sources
    - Historisation complete
    - Requetes optimisees
  end note
}

' === COUCHE INFRASTRUCTURE ===
cloud "INFRASTRUCTURE CLOUD AZURE" COLOR_SYSTEME_CLOUD {
  node "Odoo Cloud SaaS\n(Odoo.sh)" as INFRA_ODOO
  node "Apps Mobiles\n(Azure App Service)" as INFRA_APPS
  node "Data Platform\n(Azure SQL + Blob)" as INFRA_DATA
  node "Monitoring\n(Application Insights)" as INFRA_MONITORING

  note bottom of INFRA_ODOO
    EMO_SUCCESS Hebergement manage
    - Backups automatiques
    - Scalabilite auto
    - SLA 99.9%
    - Maintenance Odoo SA
  end note
}

' === RELATIONS UTILISATEURS -> APPS ===
USERS_BUREAU -down-> ODOO_CRM : Interface web
USERS_BUREAU -down-> ODOO_ACHATS : Interface web
USERS_BUREAU -down-> ODOO_PROJETS : Interface web
USERS_BUREAU -down-> SIRH_PAIE : Portail RH
USERS_BUREAU -down-> BI_POWERBI : Dashboards

USERS_TERRAIN -down-> APP_CHANTIERS : App mobile
USERS_TERRAIN -down-> APP_MT : App mobile
USERS_TERRAIN -down-> APP_COMMERCIAL : App mobile

' === RELATIONS APPS -> INTEGRATION ===
ODOO_CRM -down-> API_ODOO
ODOO_ACHATS -down-> API_ODOO
ODOO_STOCK -down-> API_ODOO
ODOO_PROJETS -down-> API_ODOO
ODOO_COMPTA -down-> API_ODOO
ODOO_FACT -down-> API_ODOO

APP_CHANTIERS -down-> API_MOBILE
APP_MT -down-> API_MOBILE
APP_COMMERCIAL -down-> API_MOBILE

SIRH_PAIE -down-> API_SIRH
SIRH_CONGES -down-> API_SIRH

CRM_CONTACTS -down-> API_CRM
CRM_PIPELINE -down-> API_CRM

' === RELATIONS INTEGRATION -> DATA ===
API_ODOO -down-> QUEUE : Events
API_MOBILE -down-> QUEUE : Sync
API_SIRH -down-> QUEUE : Updates

QUEUE -down-> ETL : Consume
ETL -down-> LAKE : Raw data
ETL -down-> DWH : Transformed

DWH -down-> BI_POWERBI : Requetes
DWH -down-> BI_METABASE : Requetes

' === RELATIONS APPS -> INFRASTRUCTURE ===
ODOO_CRM -down-> INFRA_ODOO : Heberge
ODOO_ACHATS -down-> INFRA_ODOO
ODOO_STOCK -down-> INFRA_ODOO
ODOO_PROJETS -down-> INFRA_ODOO

APP_CHANTIERS -down-> INFRA_APPS : Heberge
APP_MT -down-> INFRA_APPS
APP_COMMERCIAL -down-> INFRA_APPS

DWH -down-> INFRA_DATA : Heberge
LAKE -down-> INFRA_DATA : Heberge

API_ODOO -down-> INFRA_MONITORING : Logs/Metrics
API_MOBILE -down-> INFRA_MONITORING
ETL -down-> INFRA_MONITORING

' === METRIQUES CIBLES ===
note bottom
  **GAINS TRANSFORMATION ATTENDUS**

  EMO_SUCCESS **Productivite:**
  - Temps saisie: -60% (automatisation)
  - Temps reporting: -80% (dashboards temps reel)
  - Erreurs: -90% (validation systeme)
  - Recherche info: -95% (source unique)

  EMO_MONEY **ROI 18 mois:**
  - Investissement: 165-282K€
  - Gains annuels: 150-250K€
  - Breakeven: M12-M15

  EMO_SUCCESS **Qualite:**
  - Source unique verite (100% data)
  - Tracabilite complete (audit trail)
  - Disponibilite 99.9% (Cloud SaaS)
  - Conformite RGPD garantie

  EMO_SUCCESS **Utilisateurs:**
  - Formation 2j/user
  - Support 24/7 (tickets)
  - Champions internes (3 par service)
end note

LEGEND_ARCHITECTURE()

@enduml
